<!DOCTYPE html>
<html lang="es">
<head>
    <script src="js/i18n.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <link rel="stylesheet" type="text/css" href="https://npmcdn.com/flatpickr/dist/themes/white.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="shortcut icon" href="utils/img/Logo sin fondo.png" type="image/x-icon">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/contacto.css">
    <title data-i18n="head.inicio">Inicio | Arima Taberna</title>

</head>
<body>
    <main-navbar></main-navbar>

    <main class="main-index">
        <h1 data-i18n="inicio.titulo" class="inicio-titulo">Inicio</h1>
        <section id="reservas" class="reserva-container">
            <div class="columna-calendario">
                <h3 data-i18n="inicio.selecciona-fecha">ðŸ“… Selecciona Fecha</h3>
                <input type="text" id="calendario-visible">
                <input type="hidden" id="fecha-hidden" name="fecha">
            </div>
            <div class="columna-formulario">
                <h3 data-i18n="inicio.reservas">Completa tu Reserva</h3>
                <div data-i18n="inicio.selecciona_fecha" class="fecha-seleccionada" id="fecha-display">
                    ðŸ“… Selecciona una fecha â†’
                </div>
                <form action="procesar-reserva.php" method="POST" id="form-reserva">
                    <div class="fila-formulario">
                        <div class="campo">
                            <label data-i18n="inicio.hora">Hora *</label>
                            <select id="hora" name="hora" required>
                                <option value="">--:--</option>
                                <option value="12:00">12:00</option>
                                <option value="12:30">12:30</option>
                                <option value="13:00">13:00</option>
                                <option value="13:30">13:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                                <option value="20:00">20:00</option>
                                <option value="20:30">20:30</option>
                                <option value="21:00">21:00</option>
                                <option value="21:30">21:30</option>
                                <option value="22:00">22:00</option>
                                <option value="22:30">22:30</option>
                            </select>
                        </div>
                        <div class="campo">
                            <label data-i18n="inicio.personas">Personas *</label>
                            <select id="personas" name="personas" required>
                                <option value="">-</option>
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                                <option value="6">6</option>
                                <option value="7">7</option>
                                <option value="8">8</option>
                            </select>
                        </div>
                        <div class="campo campo-comentarios">
                            <label data-i18n="inicio.comentarios">Comentarios (opcional)</label>
                            <textarea data-i18n="inicio.preferencias" id="comentarios" name="comentarios" placeholder="Alergias, preferencias..."></textarea>
                        </div>
                    </div>
                    <div class="fila-final">
                        <div class="checkbox-group">
                            <input type="checkbox" id="privacidad" name="privacidad" required>
                            <label for="privacidad" data-i18n="inicio.privacidad">Acepto la polÃ­tica de privacidad *</label>
                        </div>
                        <div class="grupo-botones">
                            <button type="reset" class="boton-secundario buttons" data-i18n="inicio.limpiar">Limpiar</button>
                            <button type="submit" class="boton-principal buttons" data-i18n="inicio.reservar">Reservar Mesa</button>
                        </div>
                    </div>
                </form>
            </div>
        </section>
        <div class="verMas-container">
            <a href="#menu" class="ver-mas-link">
                <h2 data-i18n="menu.menu" class="main-menu-title">
                    MenÃº
                </h2>
                <img class="flecha-abajo" src="utils/img/angulo-pequeno-hacia-abajo.svg" alt="">
            </a>
        </div>
        <aside class="sidebar">
            <nav class="sidebar-bar">
                <ul class="urlSidebar">
                    <li>
                        <a href="#desayuno" data-i18n="menu.categoria1">
                            Desayunos
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#arima-bol" data-i18n="menu.categoria2">
                            Arima Bol
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#bolleria" data-i18n="menu.categoria3">
                            BollerÃ­a
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#snacks" data-i18n="menu.categoria4">
                            Snacks
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#ensaladas" data-i18n="menu.categoria5">
                            Ensaladas
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#pasta" data-i18n="menu.categoria6">
                            Pastas
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#para-compartir" data-i18n="menu.categoria7">
                            Para Compartir
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#bocadillos" data-i18n="menu.categoria8">
                            Bocadillos
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#sandwich" data-i18n="menu.categoria9">
                            Sandwiches
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#hamburguesas" data-i18n="menu.categoria10">
                            Hamburguesas
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#hot-dog" data-i18n="menu.categoria11">
                            Hot Dogs
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                    <li>
                        <a href="#postres" data-i18n="menu.categoria12">
                            Postres
                            <img class="circulo-sidebar" src="utils/img/circulo-pequeno.svg" alt="Desayuno">
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>
        <section id="menu">
            <div id="platos"></div>
            <script type="module" src="./js/renderMenu.js"></script>
        </section>
    </main>

    <index-footer></index-footer>

    <script type="module" src="./js/navbar.js"></script>
    <script type="module" src="./js/footer.js"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/es.js"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/eu.js"></script>
   <script>
    let calendario;

    // Centralizamos la lÃ³gica de pintar la fecha seleccionada
    function actualizarFechaDisplay(fecha) {
        if (!fecha) {
            // Si no hay fecha, buscamos el texto de "Selecciona una fecha"
            const textoDefault = "inicio.selecciona-fecha".split('.').reduce((obj, i) => (obj ? obj[i] : null), i18n.translations);
            document.getElementById('fecha-display').innerHTML = `ðŸ“… ${textoDefault || 'Selecciona una fecha â†’'}`;
            return;
        }

        const lang = i18n.currentLang;
        const locales = { 'es': 'es-ES', 'eu': 'eu-ES' };
        
        const dia = fecha.getDate();
        // toLocaleDateString traduce el mes automÃ¡ticamente
        const mes = fecha.toLocaleDateString(locales[lang] || 'es-ES', { month: 'short' });
        const aÃ±o = fecha.getFullYear();

        document.getElementById('fecha-display').innerHTML = 
            `ðŸ“… <strong>${dia} ${mes.replace('.', '')} ${aÃ±o}</strong>`;
    }

    function initCalendario(lang) {
        if (calendario) calendario.destroy();

        calendario = flatpickr("#calendario-visible", {
            locale: lang === 'es' ? 'es' : 'eu',
            inline: true,
            minDate: "today",
            dateFormat: "Y-m-d",
            onChange: function(selectedDates, dateStr) {
                document.getElementById('fecha-hidden').value = dateStr;
                if (selectedDates.length > 0) {
                    actualizarFechaDisplay(selectedDates[0]);
                }
            }
        });
    }

    // Escuchar el evento de cambio de idioma de i18n.js
    document.addEventListener('languageChanged', () => {
        const lang = i18n.currentLang;
        
        // 1. Reiniciamos el calendario (para traducir dÃ­as de la semana y meses internos)
        initCalendario(lang);
        
        // 2. Actualizamos el texto visual de la fecha elegida
        if (calendario.selectedDates.length > 0) {
            actualizarFechaDisplay(calendario.selectedDates[0]);
        } else {
            actualizarFechaDisplay(null);
        }
    });

    document.addEventListener('DOMContentLoaded', () => {
        // El i18n.load ya se ejecuta en i18n.js, aquÃ­ solo iniciamos el calendario
        initCalendario(i18n.currentLang || 'es');
    });

    // ValidaciÃ³n del formulario
    document.getElementById('form-reserva').addEventListener('submit', function(e) {
        if (!document.getElementById('fecha-hidden').value) {
            e.preventDefault();
            const msg = i18n.currentLang === 'es' ? 'Por favor, selecciona una fecha' : 'Mesedez, hautatu data bat';
            alert(msg);
        }
    });

    // BotÃ³n Limpiar
    document.querySelector('.boton-secundario').addEventListener('click', function() {
        calendario.clear();
        document.getElementById('fecha-hidden').value = "";
        actualizarFechaDisplay(null);
    });
</script>
</body>
</html>